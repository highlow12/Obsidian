---
tags:
  - programming/Algorythem
  - 수정중
aliases:
  - 4 여왕말 문제
  - n 여왕말 문제
---
제약 충족 문제(CPS) 의 대표적인 예제
# 4 여왕말 문제
4 여왕말 문제는 1,2,3,4 네개의 여왕말이 4\*4 크기의 체스판에서 잡히지 않게 배치하는 문제
4 여왕말 문제를 정형화하면 다음과 같다
- 변수: 1부터 4까지 이름이 붙은 4개의 여왕말
- 도메인: 4\*4 모양의 체스판에 포함된 4개의 열
- 제약 조건: 서로 다른 두개의 여왕말이 하나의 행, 열, 대삭선 상에 존재하지 않음
![|200](https://raw.githubusercontent.com/codingalzi/algopy/master/jupyter-book/imgs/algo05/algo05-01a.png)
위는 앞서 언급된 제약 조건을 만족시키거나 아닌 경우를 보여준다
## 4 여왕말 문제 되추적 알고리즘
4개의 여왈말을 서로 공격하지 못하도록 배치하는 4 여왕말 문제를 해겨하는 되추적 알고리즘은 상태공간 트리를 대상으로 깊이 우선 탐색, 노드의 유망성 판단, 가지치기를 아래 과정에 따라 반복 실행한다
 - 4\*4로 이루어진 체스판에 네 개의 체스 여왕말을 놓을 수 있는 위치를 노드로 표현한 상태 공간 트리의 루트에서부터 깊이 우선 탐색을 실행
 - 탐색 과정에서 유망하지 않은 노드를 만나면 가지치기 실행 후 깊이 우선 탐색이 될수 있는 저삭 노드를 갖는 조상 노드로 되돌아가서,즉 ==되추적하여== 그곳에서부터 깊이 우선 탐색을 실행.
 - 탐색이 더 이상 진행될수 없는 경우 알고리즘 종료
<sub>4 여왕말 문제에 대해 되추적 알고리즘을 적용하는 과정</sub>
![](https://raw.githubusercontent.com/codingalzi/algopy/master/jupyter-book/imgs/algo05/algo05-06.png)
유망하지 않은 노드에서 가지치기를 하는 되추적하는 알고리즘은 그렇지 않은 일반 DFS보다 훨씬 적은 수의 노드를 탐색한다. 예를 들어 일반 DFS의 경우 155개의 노드를 탐색해야 하지만 되추적 알고리즘은 27개의 노드만 탐색한다
# n - 여왕말 문제
> 4 여왕말 문제를 일반화한 n - 여왕말 문제를 해결하는 되추적 알고리즘 구현

**문제의 변수, 도메인, 제약 조건**
- 변수: 1번무터 n번까지 이름이 붙은 n개의 여왕말
- 도메인: n\*n모양의 체스판에 포함된 1번부터 n번 열
- 제약 조건: 서로 다른 두개의 여왕말이 하나의 행, 열, 또는 대각선 상에 위치하지 않음
### 예제: 8 - 여왕말 문제
#### 상태 공간 트리
```python
from collections import defaultdict

# 변수: 네 개의 여왕말의 번호, 즉, 1, 2, ..., 8
variables = range(1, 9)

# 도메인: 각각의 여왕말이 자리잡을 수 있는 가능한 모든 열의 위치. 
# domains = 상태 공간 트리를 사전 형식으로 구현한 것
domains = defaultdict(list)

columns = range(1, 9)
for var in variables:
    domains[var] = columns
```
> [!summary]+ Output
> ```
> >> domains
> defaultdict(list,
>             {1: range(1, 9),
>              2: range(1, 9),
>              3: range(1, 9),
>              4: range(1, 9),
>              5: range(1, 9),
>              6: range(1, 9),
>              7: range(1, 9),
>              8: range(1, 9)})
> ```
#### 유망성 판단
